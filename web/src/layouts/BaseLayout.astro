---
import "../style/global.scss";

import Navbar from "./Navbar.astro";
import getUser from "../util/getUser";

interface Props {
    page: string
}

const session_id = Astro.cookies.get("session_id")?.value
let role = null

if(session_id) {
    const user_data = await getUser(session_id) as any

    if(user_data.user.roles.includes(3)) {
        role = "customer"
    } else if (user_data.user.roles.includes(4)) {
        role = "seller"
    }
}

const page = Astro.props.page
---

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <slot name="head" />
</head>
<body>
    <div id="site-container">
        <slot name="body" />
    </div>
    {
        role && <Navbar type={role} page={page} />
    }
</body>